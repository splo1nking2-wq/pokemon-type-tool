<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pokémon Multi-Type Calculator with Custom Type Editor</title>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Trebuchet MS", system-ui, sans-serif;
      background: radial-gradient(circle at top, #1e293b, #020617);
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 20px;
    }
    .app {
      width: 760px;
      max-width: 100%;
      background: #0f172a;
      border-radius: 24px;
      padding: 28px;
      box-shadow: 0 40px 90px rgba(0,0,0,.65);
      margin-bottom: 40px;
    }
    h1 {
      text-align: center;
      margin-bottom: 12px;
      letter-spacing: 1px;
    }
    .row {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }
    select, button, input, textarea {
      padding: 10px;
      border-radius: 12px;
      border: none;
      background: #1e293b;
      color: #e5e7eb;
      font-size: 14px;
      flex-grow: 1;
      min-width: 150px;
    }
    button {
      cursor: pointer;
      background: linear-gradient(135deg, #38bdf8, #6366f1);
      font-weight: bold;
      flex-grow: 0;
      width: 140px;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background: linear-gradient(135deg, #60a5fa, #818cf8);
    }
    button.secondary {
      background: #334155;
      width: 100px;
    }
    button.secondary:hover {
      background: #475569;
    }
    .pillbox {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
      min-height: 32px;
    }
    .pill {
      padding: 6px 10px;
      border-radius: 999px;
      background: #334155;
      font-size: 13px;
      user-select: none;
      position: relative;
      cursor: default;
      display: inline-flex;
      align-items: center;
    }
    .pill .remove {
      margin-left: 8px;
      background: #ef4444;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      color: white;
      font-weight: bold;
      font-size: 14px;
      line-height: 18px;
      text-align: center;
      cursor: pointer;
      user-select: none;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .results {
      margin-top: 18px;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 14px;
    }
    .panel {
      background: #020617;
      border-radius: 16px;
      padding: 12px;
      min-height: 70px;
      word-wrap: break-word;
    }
    .panel h3 {
      margin-top: 0;
      font-size: 15px;
      margin-bottom: 6px;
      border-bottom: 1px solid #334155;
      padding-bottom: 4px;
    }
    label {
      font-size: 14px;
      margin-bottom: 4px;
      display: block;
      color: #94a3b8;
    }
    textarea, input[type="text"] {
      font-family: monospace;
      font-size: 13px;
      resize: vertical;
      background: #1e293b;
      color: #e5e7eb;
      border: none;
      border-radius: 12px;
      padding: 8px;
      width: 100%;
      box-sizing: border-box;
      min-height: 32px;
    }
    textarea {
      min-height: 60px;
    }
    .custom-type-form {
      background: #14233c;
      padding: 20px;
      border-radius: 20px;
      margin-bottom: 28px;
      box-shadow: 0 0 20px #0e3f82;
    }
    .custom-type-form h2 {
      margin-top: 0;
      text-align: center;
      color: #7dd3fc;
      margin-bottom: 16px;
    }
    .form-row {
      margin-bottom: 12px;
    }
  </style>
</head>

<body>
  <div class="app">
    <h1>Pokémon Type Calculator</h1>

    <!-- Type Selection -->
    <div class="row">
      <select id="typeSelect"></select>
      <button onclick="addType()">Add Type</button>
      <button class="secondary" onclick="clearTypes()">Clear</button>
    </div>

    <div class="pillbox" id="chosenTypes" title="Selected Types"></div>

    <div class="results">
      <div class="panel">
        <h3>Weak Against</h3>
        <div id="weak">None</div>
      </div>
      <div class="panel">
        <h3>Resistant To</h3>
        <div id="resist">None</div>
      </div>
      <div class="panel">
        <h3>Immune To</h3>
        <div id="immune">None</div>
      </div>
      <div class="panel">
        <h3>Offensively Strong Against</h3>
        <div id="strong">None</div>
      </div>
      <div class="panel" style="grid-column: 1 / -1;">
        <h3>Offensively Resisted By</h3>
        <div id="blocked">None</div>
      </div>
    </div>
  </div>

  <div class="app custom-type-form">
    <h2>Add Custom Type</h2>

    <div class="form-row">
      <label for="customName">Type Name</label>
      <input id="customName" type="text" placeholder="E.g. Cosmic" />
    </div>
    <div class="form-row">
      <label for="customWeak">Weaknesses (comma separated)</label>
      <textarea id="customWeak" placeholder="E.g. Fire, Ice"></textarea>
    </div>
    <div class="form-row">
      <label for="customResist">Resistances (comma separated)</label>
      <textarea id="customResist" placeholder="E.g. Psychic, Dark"></textarea>
    </div>
    <div class="form-row">
      <label for="customImmune">Immunities (comma separated)</label>
      <textarea id="customImmune" placeholder="E.g. Normal"></textarea>
    </div>
    <div class="form-row">
      <label for="customStrong">Offensive Strengths (comma separated)</label>
      <textarea id="customStrong" placeholder="E.g. Fairy, Dragon"></textarea>
    </div>
    <div class="form-row">
      <label for="customBlocked">Offensive Resistances (blocked) (comma separated)</label>
      <textarea id="customBlocked" placeholder="E.g. Steel"></textarea>
    </div>

    <button onclick="addCustomType()">Add Custom Type</button>
  </div>

  <script>
    const ALL_TYPES = [
      "Normal", "Fire", "Water", "Electric", "Grass", "Ice",
      "Fighting", "Poison", "Ground", "Flying", "Psychic",
      "Bug", "Rock", "Ghost", "Dragon", "Dark", "Steel",
      "Fairy", "Stellar",
      // Custom types added here dynamically
    ];

    const typeChart = {
      Normal: { weak: ["Fighting"], resist: [], immune: ["Ghost"], strong: [], blocked: [] },
      Fire: { weak: ["Water", "Rock", "Ground"], resist: ["Fire", "Grass", "Ice", "Bug", "Steel", "Fairy"], immune: [], strong: ["Grass", "Ice", "Bug", "Steel"], blocked: ["Water", "Rock", "Fire"] },
      Water: { weak: ["Electric", "Grass"], resist: ["Fire", "Water", "Ice", "Steel"], immune: [], strong: ["Fire", "Rock", "Ground"], blocked: ["Water", "Grass", "Dragon"] },
      Electric: { weak: ["Ground"], resist: ["Electric", "Flying", "Steel"], immune: [], strong: ["Water", "Flying"], blocked: ["Electric", "Grass", "Dragon"] },
      Grass: { weak: ["Fire", "Ice", "Poison", "Flying", "Bug"], resist: ["Water", "Electric", "Grass", "Ground"], immune: [], strong: ["Water", "Rock", "Ground"], blocked: ["Fire", "Grass", "Poison", "Flying", "Bug", "Dragon", "Steel"] },
      Ice: { weak: ["Fire", "Fighting", "Rock", "Steel"], resist: ["Ice"], immune: [], strong: ["Grass", "Ground", "Flying", "Dragon"], blocked: ["Fire", "Water", "Ice", "Steel"] },
      Fighting: { weak: ["Flying", "Psychic", "Fairy"], resist: ["Bug", "Rock", "Dark"], immune: [], strong: ["Normal", "Ice", "Rock", "Dark", "Steel"], blocked: ["Poison", "Flying", "Psychic", "Bug", "Fairy"] },
      Poison: { weak: ["Ground", "Psychic"], resist: ["Grass", "Fighting", "Poison", "Bug", "Fairy"], immune: [], strong: ["Grass", "Fairy"], blocked: ["Poison", "Ground", "Rock", "Ghost"] },
      Ground: { weak: ["Water", "Grass", "Ice"], resist: ["Poison", "Rock"], immune: ["Electric"], strong: ["Fire", "Electric", "Poison", "Rock", "Steel"], blocked: ["Grass", "Bug"] },
      Flying: { weak: ["Electric", "Ice", "Rock"], resist: ["Grass", "Fighting", "Bug"], immune: ["Ground"], strong: ["Grass", "Fighting", "Bug"], blocked: ["Electric", "Rock", "Steel"] },
      Psychic: { weak: ["Bug", "Ghost", "Dark"], resist: ["Fighting", "Psychic"], immune: [], strong: ["Fighting", "Poison"], blocked: ["Steel", "Psychic"] },
      Bug: { weak: ["Fire", "Flying", "Rock"], resist: ["Grass", "Fighting", "Ground"], immune: [], strong: ["Grass", "Psychic", "Dark"], blocked: ["Fire", "Fighting", "Poison", "Flying", "Ghost", "Steel", "Fairy"] },
      Rock: { weak: ["Water", "Grass", "Fighting", "Ground", "Steel"], resist: ["Normal", "Fire", "Poison", "Flying"], immune: [], strong: ["Fire", "Ice", "Flying", "Bug"], blocked: ["Fighting", "Ground", "Steel"] },
      Ghost: { weak: ["Ghost", "Dark"], resist: ["Poison", "Bug"], immune: ["Normal", "Fighting"], strong: ["Psychic", "Ghost"], blocked: ["Dark"] },
      Dragon: { weak: ["Ice", "Dragon", "Fairy"], resist: ["Fire", "Water", "Electric", "Grass"], immune: [], strong: ["Dragon"], blocked: ["Steel", "Fairy"] },
      Dark: { weak: ["Fighting", "Bug", "Fairy"], resist: ["Ghost", "Dark"], immune: ["Psychic"], strong: ["Psychic", "Ghost"], blocked: ["Fighting", "Dark", "Fairy"] },
      Steel: { weak: ["Fire", "Fighting", "Ground"], resist: ["Normal", "Grass", "Ice", "Flying", "Psychic", "Bug", "Rock", "Dragon", "Steel", "Fairy"], immune: ["Poison"], strong: ["Ice", "Rock", "Fairy"], blocked: ["Fire", "Water", "Electric", "Steel"] },
      Fairy: { weak: ["Poison", "Steel"], resist: ["Fighting", "Bug", "Dark"], immune: ["Dragon"], strong: ["Fighting", "Dragon", "Dark"], blocked: ["Fire", "Poison", "Steel"] },
      Stellar: { weak: [], resist: [], immune: [], strong: ALL_TYPES.filter(t => t !== "Stellar"), blocked: [] },
    };

    let selectedTypes = [];

    const typeSelect = document.getElementById("typeSelect");
    const chosenTypesContainer = document.getElementById("chosenTypes");

    function populateTypes() {
      typeSelect.innerHTML = "";
      ALL_TYPES.forEach(type => {
        const option = document.createElement("option");
        option.value = type;
        option.textContent = type;
        typeSelect.appendChild(option);
      });
    }

    populateTypes();

    function addType() {
      const type = typeSelect.value;
      if (!type) return;

      if (!selectedTypes.includes(type)) {
        selectedTypes.push(type);
        updateUI();
      }
    }

    function clearTypes() {
      selectedTypes = [];
      updateUI();
    }

    function merge(field) {
      const merged = new Set();
      selectedTypes.forEach(type => {
        (typeChart[type]?.[field] || []).forEach(t => merged.add(t));
      });
      selectedTypes.forEach(t => merged.delete(t));
      return [...merged].sort();
    }

    function updateUI() {
      chosenTypesContainer.innerHTML = selectedTypes
        .map(type => `
          <span class="pill">${type}<span class="remove" onclick="removeType('${type}')">×</span></span>
        `)
        .join("");

      document.getElementById("weak").textContent = merge("weak").join(", ") || "None";
      document.getElementById("resist").textContent = merge("resist").join(", ") || "None";
      document.getElementById("immune").textContent = merge("immune").join(", ") || "None";
      document.getElementById("strong").textContent = merge("strong").join(", ") || "None";
      document.getElementById("blocked").textContent = merge("blocked").join(", ") || "None";
    }

    function removeType(type) {
      selectedTypes = selectedTypes.filter(t => t !== type);
      updateUI();
    }

    // Add custom type from form inputs
    function addCustomType() {
      const nameInput = document.getElementById("customName");
      const weakInput = document.getElementById("customWeak");
      const resistInput = document.getElementById("customResist");
      const immuneInput = document.getElementById("customImmune");
      const strongInput = document.getElementById("customStrong");
      const blockedInput = document.getElementById("customBlocked");

      const name = nameInput.value.trim();
      if (!name) {
        alert("Please enter a custom type name.");
        return;
      }

      if (typeChart[name]) {
        alert("This type already exists.");
        return;
      }

      // Helper to parse comma separated inputs
      function parseList(text) {
        if (!text.trim()) return [];
        return text.split(",").map(s => s.trim()).filter(Boolean);
      }

      const weak = parseList(weakInput.value);
      const resist = parseList(resistInput.value);
      const immune = parseList(immuneInput.value);
      const strong = parseList(strongInput.value);
      const blocked = parseList(blockedInput.value);

      typeChart[name] = { weak, resist, immune, strong, blocked };
      ALL_TYPES.push(name);

      populateTypes();

      // Clear inputs after adding
      nameInput.value = "";
      weakInput.value = "";
      resistInput.value = "";
      immuneInput.value = "";
      strongInput.value = "";
      blockedInput.value = "";

      alert(`Custom type "${name}" added! You can now select it from the dropdown.`)
    }
  </script>
</body>
</html>
