<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pokémon Multi-Type Calculator</title>

  <!-- ================= CSS (STYLES GO HERE) ================= -->
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Trebuchet MS", system-ui, sans-serif;
      background: radial-gradient(circle at top, #1e293b, #020617);
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .app {
      width: 760px;
      max-width: 100%;
      background: #0f172a;
      border-radius: 24px;
      padding: 28px;
      box-shadow: 0 40px 90px rgba(0,0,0,.65);
    }

    h1 {
      text-align: center;
      margin-bottom: 8px;
      letter-spacing: 1px;
    }

    .subtitle {
      text-align: center;
      opacity: .8;
      margin-bottom: 20px;
    }

    .row {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
    }

    select, button, textarea {
      padding: 10px;
      border-radius: 12px;
      border: none;
      background: #1e293b;
      color: #e5e7eb;
      font-size: 14px;
      flex-grow: 1;
    }

    button {
      cursor: pointer;
      background: linear-gradient(135deg, #38bdf8, #6366f1);
      font-weight: bold;
      flex-grow: 0;
      width: 120px;
    }

    button.secondary {
      background: #334155;
    }

    .pillbox {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
      min-height: 32px;
    }

    .pill {
      padding: 6px 10px;
      border-radius: 999px;
      background: #334155;
      font-size: 13px;
      user-select: none;
      position: relative;
      cursor: default;
    }

    .pill .remove {
      position: absolute;
      top: -6px;
      right: -6px;
      background: #ef4444;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      color: white;
      font-weight: bold;
      font-size: 14px;
      line-height: 18px;
      text-align: center;
      cursor: pointer;
      user-select: none;
    }

    .results {
      margin-top: 18px;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 14px;
    }

    .panel {
      background: #020617;
      border-radius: 16px;
      padding: 12px;
      min-height: 70px;
    }

    .panel h3 {
      margin-top: 0;
      font-size: 15px;
      margin-bottom: 6px;
      border-bottom: 1px solid #334155;
      padding-bottom: 4px;
    }

    textarea {
      width: 100%;
      resize: vertical;
      min-height: 90px;
      margin-top: 10px;
      font-family: monospace;
      font-size: 13px;
    }
  </style>
</head>

<body>

  <!-- ================= HTML (UI GOES HERE) ================= -->
  <div class="app">
    <h1>Pokémon Type Engine</h1>
    <div class="subtitle">
      Supports unlimited types, Stellar, custom types with full weaknesses and strengths, and AI-assisted design
    </div>

    <div class="row">
      <select id="typeSelect"></select>
      <button onclick="addType()">Add Type</button>
      <button class="secondary" onclick="clearTypes()">Clear</button>
    </div>

    <div class="pillbox" id="chosenTypes" title="Selected Types"></div>

    <div class="results">
      <div class="panel">
        <h3>Weak Against</h3>
        <div id="weak">None</div>
      </div>
      <div class="panel">
        <h3>Resistant To</h3>
        <div id="resist">None</div>
      </div>
      <div class="panel">
        <h3>Immune To</h3>
        <div id="immune">None</div>
      </div>
      <div class="panel">
        <h3>Offensively Strong Against</h3>
        <div id="strong">None</div>
      </div>
      <div class="panel" style="grid-column: 1 / -1;">
        <h3>Offensively Resisted By</h3>
        <div id="blocked">None</div>
      </div>
    </div>

    <textarea id="aiPrompt" placeholder="Ask the AI to design a Pokémon using these types…"></textarea>
    <button onclick="generatePrompt()">Generate Pokémon Design Prompt</button>
  </div>

  <!-- ================= JAVASCRIPT (LOGIC GOES HERE) ================= -->
  <script>
    // Full list of types, including Stellar and Custom
    const ALL_TYPES = [
      "Normal", "Fire", "Water", "Electric", "Grass", "Ice",
      "Fighting", "Poison", "Ground", "Flying", "Psychic",
      "Bug", "Rock", "Ghost", "Dragon", "Dark", "Steel",
      "Fairy", "Stellar",
      "Custom"
    ];

    // Type effectiveness chart (simplified example, expand as needed)
    const typeChart = {
      Normal: { weak: ["Fighting"], resist: [], immune: ["Ghost"], strong: [], blocked: [] },
      Fire: { weak: ["Water", "Rock", "Ground"], resist: ["Fire", "Grass", "Ice", "Bug", "Steel", "Fairy"], immune: [], strong: ["Grass", "Ice", "Bug", "Steel"], blocked: ["Water", "Rock", "Fire"] },
      Water: { weak: ["Electric", "Grass"], resist: ["Fire", "Water", "Ice", "Steel"], immune: [], strong: ["Fire", "Rock", "Ground"], blocked: ["Water", "Grass", "Dragon"] },
      Electric: { weak: ["Ground"], resist: ["Electric", "Flying", "Steel"], immune: [], strong: ["Water", "Flying"], blocked: ["Electric", "Grass", "Dragon"] },
      Grass: { weak: ["Fire", "Ice", "Poison", "Flying", "Bug"], resist: ["Water", "Electric", "Grass", "Ground"], immune: [], strong: ["Water", "Rock", "Ground"], blocked: ["Fire", "Grass", "Poison", "Flying", "Bug", "Dragon", "Steel"] },
      Ice: { weak: ["Fire", "Fighting", "Rock", "Steel"], resist: ["Ice"], immune: [], strong: ["Grass", "Ground", "Flying", "Dragon"], blocked: ["Fire", "Water", "Ice", "Steel"] },
      Fighting: { weak: ["Flying", "Psychic", "Fairy"], resist: ["Bug", "Rock", "Dark"], immune: [], strong: ["Normal", "Ice", "Rock", "Dark", "Steel"], blocked: ["Poison", "Flying", "Psychic", "Bug", "Fairy"] },
      Poison: { weak: ["Ground", "Psychic"], resist: ["Grass", "Fighting", "Poison", "Bug", "Fairy"], immune: [], strong: ["Grass", "Fairy"], blocked: ["Poison", "Ground", "Rock", "Ghost"] },
      Ground: { weak: ["Water", "Grass", "Ice"], resist: ["Poison", "Rock"], immune: ["Electric"], strong: ["Fire", "Electric", "Poison", "Rock", "Steel"], blocked: ["Grass", "Bug"] },
      Flying: { weak: ["Electric", "Ice", "Rock"], resist: ["Grass", "Fighting", "Bug"], immune: ["Ground"], strong: ["Grass", "Fighting", "Bug"], blocked: ["Electric", "Rock", "Steel"] },
      Psychic: { weak: ["Bug", "Ghost", "Dark"], resist: ["Fighting", "Psychic"], immune: [], strong: ["Fighting", "Poison"], blocked: ["Steel", "Psychic"] },
      Bug: { weak: ["Fire", "Flying", "Rock"], resist: ["Grass", "Fighting", "Ground"], immune: [], strong: ["Grass", "Psychic", "Dark"], blocked: ["Fire", "Fighting", "Poison", "Flying", "Ghost", "Steel", "Fairy"] },
      Rock: { weak: ["Water", "Grass", "Fighting", "Ground", "Steel"], resist: ["Normal", "Fire", "Poison", "Flying"], immune: [], strong: ["Fire", "Ice", "Flying", "Bug"], blocked: ["Fighting", "Ground", "Steel"] },
      Ghost: { weak: ["Ghost", "Dark"], resist: ["Poison", "Bug"], immune: ["Normal", "Fighting"], strong: ["Psychic", "Ghost"], blocked: ["Dark"] },
      Dragon: { weak: ["Ice", "Dragon", "Fairy"], resist: ["Fire", "Water", "Electric", "Grass"], immune: [], strong: ["Dragon"], blocked: ["Steel", "Fairy"] },
      Dark: { weak: ["Fighting", "Bug", "Fairy"], resist: ["Ghost", "Dark"], immune: ["Psychic"], strong: ["Psychic", "Ghost"], blocked: ["Fighting", "Dark", "Fairy"] },
      Steel: { weak: ["Fire", "Fighting", "Ground"], resist: ["Normal", "Grass", "Ice", "Flying", "Psychic", "Bug", "Rock", "Dragon", "Steel", "Fairy"], immune: ["Poison"], strong: ["Ice", "Rock", "Fairy"], blocked: ["Fire", "Water", "Electric", "Steel"] },
      Fairy: { weak: ["Poison", "Steel"], resist: ["Fighting", "Bug", "Dark"], immune: ["Dragon"], strong: ["Fighting", "Dragon", "Dark"], blocked: ["Fire", "Poison", "Steel"] },
      Stellar: { weak: [], resist: [], immune: [], strong: ALL_TYPES.filter(t => t !== "Stellar" && t !== "Custom"), blocked: [] },
      // Custom types will be added dynamically
    };

    let selectedTypes = [];

    const typeSelect = document.getElementById("typeSelect");
    const chosenTypesContainer = document.getElementById("chosenTypes");

    function populateTypes() {
      typeSelect.innerHTML = "";
      ALL_TYPES.forEach(type => {
        const option = document.createElement("option");
        option.value = type;
        option.textContent = type;
        typeSelect.appendChild(option);
      });
    }

    populateTypes();

    function addType() {
      let type = typeSelect.value;

      if (type === "Custom") {
        type = prompt("Enter your custom type name:").trim();
        if (!type) {
          alert("Custom type name cannot be empty!");
          return;
        }

        if (typeChart[type]) {
          alert("That custom type name already exists. Choose a different name.");
          return;
        }

        // Helper to get comma-separated list and clean it up
        function getListInput(message) {
          const input = prompt(message + " (comma separated, leave blank for none):");
          if (!input) return [];
          return input.split(",").map(s => s.trim()).filter(Boolean);
        }

        const weak = getListInput("Enter weaknesses");
        const resist = getListInput("Enter resistances");
        const immune = getListInput("Enter immunities");
        const strong = getListInput("Enter offensive strengths");
        const blocked = getListInput("Enter offensive resistances (blocked)");

        typeChart[type] = { weak, resist, immune, strong, blocked };
        ALL_TYPES.push(type);
        populateTypes();
      }

      if (!selectedTypes.includes(type)) {
        selectedTypes.push(type);
        updateUI();
      }
    }

    function clearTypes() {
      selectedTypes = [];
      updateUI();
    }

    function merge(field) {
      const merged = new Set();
      selectedTypes.forEach(type => {
        (typeChart[type]?.[field] || []).forEach(t => merged.add(t));
      });
      // Remove any types that are also selected to avoid confusion
      selectedTypes.forEach(t => merged.delete(t));
      return [...merged].sort();
    }

    function updateUI() {
      // Show selected types as pills with remove buttons
      chosenTypesContainer.innerHTML = selectedTypes
        .map(type => `
          <span class="pill">${type}<span class="remove" onclick="removeType('${type}')">×</span></span>
        `)
        .join("");

      // Update all results
      document.getElementById("weak").textContent = merge("weak").join(", ") || "None";
      document.getElementById("resist").textContent = merge("resist").join(", ") || "None";
      document.getElementById("immune").textContent = merge("immune").join(", ") || "None";
      document.getElementById("strong").textContent = merge("strong").join(", ") || "None";
      document.getElementById("blocked").textContent = merge("blocked").join(", ") || "None";
    }

    function removeType(type) {
      selectedTypes = selectedTypes.filter(t => t !== type);
      updateUI();
    }

    function generatePrompt() {
      if (selectedTypes.length === 0) {
        alert("Please add at least one type to generate a prompt.");
        return;
      }
      const prompt = `
Design a Pokémon with the following types: ${selectedTypes.join(", ")}.
Art style: Ken Sugimori official Pokémon illustration.
Include anatomy, personality, habitat, signature move, and visual motifs inspired by its typing.
`;
      document.getElementById("aiPrompt").value = prompt.trim();
    }
  </script>

</body>
</html>
